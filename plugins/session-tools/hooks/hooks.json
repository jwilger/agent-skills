{
  "hooks": {
    "PreCompact": [
      {
        "matcher": "auto|manual",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/auto-save-state.sh",
            "statusMessage": "Saving session state before compaction...",
            "timeout": 30
          }
        ]
      }
    ],
    "SessionStart": [
      {
        "matcher": "startup|resume",
        "hooks": [
          {
            "type": "command",
            "command": "cd \"$CLAUDE_PROJECT_DIR\" && ${CLAUDE_PLUGIN_ROOT}/scripts/ensure-skills.sh",
            "statusMessage": "Checking required skills for session-tools...",
            "timeout": 60
          },
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/restore-state.sh",
            "statusMessage": "Restoring session context...",
            "timeout": 30
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "cd \"$CLAUDE_PROJECT_DIR\" && if [ -n \"$(git status --porcelain 2>/dev/null)\" ]; then echo 'STOP BLOCKED â€” DIRTY WORKING TREE. You MUST take action NOW. Do NOT report this to the user and wait for instructions. Do NOT ask permission. (1) Run git status to see what changed. (2) Commit all meaningful work with a descriptive message. (3) If changes are experimental or broken, stash them with git stash -m WIP: description. Only after the working tree is clean may you end the session.' >&2; exit 1; fi",
            "timeout": 10
          }
        ]
      }
    ]
  }
}
